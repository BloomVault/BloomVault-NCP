<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Strain Catalogue · BloomVault Farms</title>
  <link rel="stylesheet" href="assets/css/styles.css" />
  <link rel="stylesheet" href="assets/css/overrides.css" />

  <!-- Badge styling (scoped to catalog) -->
  <style>
    #catalog .add-to-quote { position: relative; }
    #catalog .add-to-quote .count-badge{
      position:absolute; top:-8px; right:-8px;
      min-width:20px; height:20px; padding:0 6px;
      border-radius:9999px; display:none; align-items:center; justify-content:center;
      font-size:12px; line-height:1; font-weight:700;
      background:linear-gradient(#caa95a,#b58c2b); color:#111; border:1px solid #8b6b18;
      box-shadow:0 1px 2px rgba(0,0,0,.25);
    }
    #catalog .add-to-quote[data-count]:not([data-count="0"]) .count-badge { display:inline-flex; }
  </style>
</head>
<body>
  <div class="wrapper">
    <div class="sidebar">
      <div class="brand"><img src="assets/img/logo.png" alt="BloomVault Farms" /></div>
      <nav class="tabs">
        <a class="tab" href="index.html">Home</a>
        <a class="tab" href="catalogue.html">Strain Catalogue</a>
        <a class="tab" href="quote.html">Get a Quote</a>
        <a class="tab" href="contact.html">Contact Us</a>
      </nav>
      <div class="badge small">Serving Virginia commercial growers only</div>
    </div>

    <main class="main" id="catalog">
      <section class="container">
        <h1>Strain Catalogue</h1>

        <!-- Uniform grid wrapper -->
        <div class="catalog-grid">

          <!-- Card 1 -->
          <article class="card">
            <div class="media">
              <img src="assets/img/sticky-icky.jpg" alt="Sticky Icky" />
            </div>
            <div class="content">
              <h3>Sticky Icky</h3>
              <p>Gorilla Glue #4 X Animal Cookies.</p>
              <div class="actions">
                <a class="btn" href="strain.html?id=1">Details</a>
                <button type="button" class="btn add-to-quote" data-id="1" data-name="Sticky Icky">
                  Add to Quote +1 <span class="count-badge">0</span>
                </button>
              </div>
              <p class="small">Image &amp; details are placeholders.</p>
            </div>
          </article>

          <!-- Card 2 -->
          <article class="card">
            <div class="media">
              <img src="assets/img/strain_2.jpg" alt="Placeholder Strain #2" onerror="this.style.opacity=.3" />
            </div>
            <div class="content">
              <h3>Placeholder Strain #2</h3>
              <div class="actions">
                <a class="btn" href="strain.html?id=2">Details</a>
                <button type="button" class="btn add-to-quote" data-id="2" data-name="Placeholder Strain #2">
                  Add to Quote +1 <span class="count-badge">0</span>
                </button>
              </div>
              <p class="small">Image &amp; details are placeholders.</p>
            </div>
          </article>

          <!-- Card 3 -->
          <article class="card">
            <div class="media">
              <img src="assets/img/strain_3.jpg" alt="Placeholder Strain #3" onerror="this.style.opacity=.3" />
            </div>
            <div class="content">
              <h3>Placeholder Strain #3</h3>
              <div class="actions">
                <a class="btn" href="strain.html?id=3">Details</a>
                <button type="button" class="btn add-to-quote" data-id="3" data-name="Placeholder Strain #3">
                  Add to Quote +1 <span class="count-badge">0</span>
                </button>
              </div>
              <p class="small">Image &amp; details are placeholders.</p>
            </div>
          </article>

          <!-- Card 4 -->
          <article class="card">
            <div class="media">
              <img src="assets/img/strain_4.jpg" alt="Placeholder Strain #4" onerror="this.style.opacity=.3" />
            </div>
            <div class="content">
              <h3>Placeholder Strain #4</h3>
              <div class="actions">
                <a class="btn" href="strain.html?id=4">Details</a>
                <button type="button" class="btn add-to-quote" data-id="4" data-name="Placeholder Strain #4">
                  Add to Quote +1 <span class="count-badge">0</span>
                </button>
              </div>
              <p class="small">Image &amp; details are placeholders.</p>
            </div>
          </article>

          <!-- Card 5 -->
          <article class="card">
            <div class="media">
              <img src="assets/img/strain_5.jpg" alt="Placeholder Strain #5" onerror="this.style.opacity=.3" />
            </div>
            <div class="content">
              <h3>Placeholder Strain #5</h3>
              <div class="actions">
                <a class="btn" href="strain.html?id=5">Details</a>
                <button type="button" class="btn add-to-quote" data-id="5" data-name="Placeholder Strain #5">
                  Add to Quote +1 <span class="count-badge">0</span>
                </button>
              </div>
              <p class="small">Image &amp; details are placeholders.</p>
            </div>
          </article>

          <!-- Card 6 -->
          <article class="card">
            <div class="media">
              <img src="assets/img/strain_6.jpg" alt="Placeholder Strain #6" onerror="this.style.opacity=.3" />
            </div>
            <div class="content">
              <h3>Placeholder Strain #6</h3>
              <div class="actions">
                <a class="btn" href="strain.html?id=6">Details</a>
                <button type="button" class="btn add-to-quote" data-id="6" data-name="Placeholder Strain #6">
                  Add to Quote +1 <span class="count-badge">0</span>
                </button>
              </div>
              <p class="small">Image &amp; details are placeholders.</p>
            </div>
          </article>

          <!-- Card 7 -->
          <article class="card">
            <div class="media">
              <img src="assets/img/strain_7.jpg" alt="Placeholder Strain #7" onerror="this.style.opacity=.3" />
            </div>
            <div class="content">
              <h3>Placeholder Strain #7</h3>
              <div class="actions">
                <a class="btn" href="strain.html?id=7">Details</a>
                <button type="button" class="btn add-to-quote" data-id="7" data-name="Placeholder Strain #7">
                  Add to Quote +1 <span class="count-badge">0</span>
                </button>
              </div>
              <p class="small">Image &amp; details are placeholders.</p>
            </div>
          </article>

          <!-- Card 8 -->
          <article class="card">
            <div class="media">
              <img src="assets/img/strain_8.jpg" alt="Placeholder Strain #8" onerror="this.style.opacity=.3" />
            </div>
            <div class="content">
              <h3>Placeholder Strain #8</h3>
              <div class="actions">
                <a class="btn" href="strain.html?id=8">Details</a>
                <button type="button" class="btn add-to-quote" data-id="8" data-name="Placeholder Strain #8">
                  Add to Quote +1 <span class="count-badge">0</span>
                </button>
              </div>
              <p class="small">Image &amp; details are placeholders.</p>
            </div>
          </article>

          <!-- Card 9 -->
          <article class="card">
            <div class="media">
              <img src="assets/img/strain_9.jpg" alt="Placeholder Strain #9" onerror="this.style.opacity=.3" />
            </div>
            <div class="content">
              <h3>Placeholder Strain #9</h3>
              <div class="actions">
                <a class="btn" href="strain.html?id=9">Details</a>
                <button type="button" class="btn add-to-quote" data-id="9" data-name="Placeholder Strain #9">
                  Add to Quote +1 <span class="count-badge">0</span>
                </button>
              </div>
              <p class="small">Image &amp; details are placeholders.</p>
            </div>
          </article>

          <!-- Card 10 -->
          <article class="card">
            <div class="media">
              <img src="assets/img/strain_10.jpg" alt="Placeholder Strain #10" onerror="this.style.opacity=.3" />
            </div>
            <div class="content">
              <h3>Placeholder Strain #10</h3>
              <div class="actions">
                <a class="btn" href="strain.html?id=10">Details</a>
                <button type="button" class="btn add-to-quote" data-id="10" data-name="Placeholder Strain #10">
                  Add to Quote +1 <span class="count-badge">0</span>
                </button>
              </div>
              <p class="small">Image &amp; details are placeholders.</p>
            </div>
          </article>

        </div><!-- /.catalog-grid -->
      </section>
    </main>
  </div>

  <!-- Optional: only needed if other pages use it -->
  <script type="module" src="assets/js/cart.js"></script>

  <!-- Add-to-Quote (no redirect) + badge counter -->
  <script>
  (function () {
    const STORAGE_KEY = "quoteCart";

    function readCart() {
      try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]"); }
      catch (e) { return []; }
    }
    function writeCart(cart) { localStorage.setItem(STORAGE_KEY, JSON.stringify(cart)); }

    function getQty(id, name) {
      const cart = readCart();
      const it = cart.find(x => x.id === String(id) && x.name === name);
      return it ? (it.qty || 0) : 0;
    }

    function ensureBadge(btn) {
      if (!btn.querySelector(".count-badge")) {
        const span = document.createElement("span");
        span.className = "count-badge";
        span.setAttribute("aria-hidden", "true");
        btn.appendChild(span);
      }
      updateBadge(btn);
    }

    function updateBadge(btn) {
      const id = btn.getAttribute("data-id");
      const name = btn.getAttribute("data-name");
      const qty = getQty(id, name);
      btn.setAttribute("data-count", String(qty));
      const span = btn.querySelector(".count-badge");
      if (span) span.textContent = String(qty);
    }

    function fallbackAdd(id, name) {
      let cart = readCart();
      const i = cart.findIndex(it => it.id === String(id) && it.name === name);
      if (i >= 0) cart[i].qty = (cart[i].qty || 0) + 1;
      else cart.push({ id: String(id), name, qty: 1 });
      writeCart(cart);
    }

    function addOne(id, name) {
      if (window.addToQuote) {
        try { window.addToQuote(id, name, 1); }
        catch (e) { console.warn("addToQuote error:", e); fallbackAdd(id, name); }
      } else {
        fallbackAdd(id, name);
      }
    }

    function toast(msg) {
      const t = document.createElement("div");
      t.textContent = msg;
      t.style.cssText =
        "position:fixed;bottom:16px;right:16px;padding:.6rem .8rem;border-radius:8px;" +
        "background:#1f2937;color:#fff;z-index:9999;opacity:0;transition:opacity .2s";
      document.body.appendChild(t);
      requestAnimationFrame(() => (t.style.opacity = "1"));
      setTimeout(() => { t.style.opacity = "0"; setTimeout(() => t.remove(), 200); }, 1000);
    }

    // Initialize badges from existing cart
    document.querySelectorAll(".add-to-quote").forEach(ensureBadge);

    // Click handler (no redirect)
    document.addEventListener("click", function (e) {
      const btn = e.target.closest(".add-to-quote");
      if (!btn) return;
      e.preventDefault();
      const id = btn.getAttribute("data-id");
      const name = btn.getAttribute("data-name");
      addOne(id, name);
      updateBadge(btn);
      toast("Added 1 × " + name);
    });

    // If cart changes in another tab, refresh counts on focus
    window.addEventListener("focus", () => {
      document.querySelectorAll(".add-to-quote").forEach(updateBadge);
    });
  })();
  </script>
</body>
</html>
